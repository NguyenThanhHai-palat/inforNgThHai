<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nghe Nhạc</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
<nav class="navbar navbar-expand-lg bg-dark" data-bs-theme="dark">
  <div class="container-fluid">
    <a class="navbar-brand" href="#"><pre>PALAT PlayerMusic</pre></a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarColor01" aria-controls="navbarColor01" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarColor01">
      <ul class="navbar-nav me-auto">
        <li class="nav-item">
          <a class="nav-link active" href="viewer.html">Trang Chủ
            <span class="visually-hidden">(current)</span>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="Upload.html">Tải Nhạc Lên</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="accout.html">Tài Khoản của tôi</a>
        </li>
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" data-bs-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">Thêm</a>
          <div class="dropdown-menu">
            <a class="dropdown-item" href="#">Báo cáo nhạc</a>
          </div>
        </li>
      </ul>
      <form class="d-flex">
        <input class="form-control me-sm-2" type="search" placeholder="Search">
        <button class="btn btn-secondary my-2 my-sm-0" type="submit">Tìm Nhạc</button>
      </form>
    </div>
  </div>
</nav>

<div class="audio-list">
  <h2>Danh sách Nhạc</h2>
  <ul id="musicList"></ul>
</div>

<audio id="audio" controls hidden>
  Your browser does not support the audio tag.
</audio>

<script>
  const audio = document.getElementById('audio');
  const musicList = document.getElementById('musicList');

  // Lấy danh sách file nhạc từ JSON và hiển thị trên trang web
  fetch('http://localhost:3000/music.json')
    .then(response => response.json())
    .then(files => {
      files.forEach(file => {
        const listItem = document.createElement('li');
        listItem.textContent = file;
        listItem.addEventListener('click', () => playMusic(file));
        musicList.appendChild(listItem);
      });
    });


  function playMusic(fileName) {
    audio.src = `https://palatplayermusicdata.glitch.me/play/${fileName}`;
    audio.play();
  }

  const toggleButton = document.getElementById('toggleButton');
  let isPlaying = false;

  function toggleAudio() {
    if (isPlaying) {
        audio.pause();
        toggleButton.innerHTML = 'Tiếp tục';
    } else {
        audio.play();
        toggleButton.innerHTML = 'Tạm dừng';
    }
    isPlaying = !isPlaying;
  }

  const timeline = document.getElementById('timeline');
  const progress = document.getElementById('progress');

  audio.addEventListener('timeupdate', () => {
    const currentTime = audio.currentTime;
    const duration = audio.duration;
    const progressWidth = (currentTime / duration) * 100;
    progress.style.width = `${progressWidth}%`;
  });

  timeline.addEventListener('click', (event) => {
    const timelineWidth = timeline.offsetWidth;
    const clickX = event.offsetX;
    const duration = audio.duration;
    const clickTime = (clickX / timelineWidth) * duration;
    audio.currentTime = clickTime;
  });
</script>
</body>
</html>
